# ADK 튜토리얼 프로젝트

이 프로젝트는 Google의 Agent Development Kit(ADK)를 이용한 지능형 에이전트 시스템 구축 튜토리얼 예제입니다.

## 프로젝트 개요

날씨 정보를 제공하는 기본 에이전트에서 시작하여 단계적으로 기능을 확장해 복잡한 멀티 에이전트 시스템을 구현하는 방법을 보여줍니다.

## 주요 구성 요소

1. **기본 에이전트 시스템** (Step 1)
   - 단일 날씨 조회 에이전트와 도구 구현
   - 기본 세션 관리 및 Runner 설정

2. **멀티 모델 지원** (Step 2)
   - LiteLLM을 활용한 다양한 LLM 모델 통합
   - 모델별 특성 비교 및 활용

3. **에이전트 팀 구성** (Step 3)
   - 인사와 작별인사를 처리하는 전문화된 하위 에이전트 구현
   - 자동 위임 메커니즘을 통한 모듈식 설계

4. **상태 관리** (Step 4)
   - 세션 상태를 통한 사용자 선호도 저장
   - 대화 턴 간 정보 유지 및 개인화 구현

5. **안전 장치** (Step 5-6)
   - LLM 호출 전 입력 검증 (before_model_callback)
   - 도구 실행 전 인자 검증 (before_tool_callback)

## 튜토리얼 내용

각 단계별 상세 설명은 [detailed_steps.md](./detailed_steps.md) 파일에서 확인할 수 있습니다.

### 주요 학습 포인트

- **에이전트 설계**: 역할과 도구 정의, 명확한 지침 제공 방법
- **모듈화**: 복잡한 시스템을 전문화된 하위 에이전트로 분리하는 방법
- **상태 관리**: 세션 상태를 활용한 컨텍스트 유지 및 개인화 구현
- **보안 및 제어**: 콜백을 통한 안전 가드레일 구현
- **유연성**: 다양한 모델과 도구 조합 방법

## 시작하기

### 필요 조건
- Python 3.9+
- Google ADK 패키지
- Gemini API 키 (또는 LiteLLM 지원 모델의 API 키)

### 설치
```bash
pip install -r requirements.txt
```

### 실행 방법
1. API 키 설정
2. 노트북 파일(adk_tutorial_kor_ipynb의_사본.ipynb) 실행

## 확장 방향

- 실제 날씨 API 연동
- 추가 하위 에이전트 개발
- 고급 콜백 기능 활용
- 세션 상태 영속화
- 웹 UI 통합

## 참고 자료

- [ADK 공식 문서](https://ai.google.dev/docs/agent_toolkit)
- [LiteLLM 문서](https://litellm.ai/docs)

2. **차단된 도시 요청(파리)**:
   - `before_model_callback`이 입력을 검사하고 통과
   - LLM이 `get_weather_stateful(city='Paris')` 호출을 결정
   - `before_tool_callback`이 city="Paris" 인자를 감지하고 차단
   - 콜백이 직접 오류 딕셔너리를 반환하고 도구 함수는 실행되지 않음
   - 중요 포인트: 도구 함수 본체가 전혀 실행되지 않음

3. **다시 허용된 도시(런던)**:
   - 두 콜백 모두 통과하여 도구가 정상 실행됨
   - `last_weather_report` 상태가 새로운 결과로 업데이트됨

**의의 및 활용**:
- **리소스 보호**: 도구로 허용되지 않은 인자가 전달되는 것을 방지
- **인자 제어**: LLM이 생성한 도구 호출 인자를 검증하고 필요시 수정 가능
- **정책 적용**: 특정 도구의 특정 인자에 대한 세부적인 제한 정책 구현 가능
- **이중 보호 계층**: 모델 콜백과 함께 사용하여 완전한 안전 장치 구현
   - 도구 실행 대신 오류 메시지 반환
   - 핵심 포인트: 실제 도구 함수는 전혀 실행되지 않음

3. **런던 날씨 요청 처리 (허용된 도시)**:
   - 두 콜백 모두 통과하여 도구 정상 실행
   - 새로운 날씨 정보가 `last_weather_report` 상태 값 업데이트

**의의 및 활용**:
- 인자 기반 제어: LLM이 도구에 전달하려는 인자를 정밀하게 제어
- 정책 적용: 특정 리소스에 대한 접근 제한 정책 구현
- 리소스 보호: 비용이 많이 들거나 민감한 API 호출 제한
- 이중 보호 계층: 모델 콜백과 함께 사용하여 완전한 안전 장치 구현

## 결론: ADK를 활용한 지능형 에이전트 시스템 구축

이 튜토리얼을 통해 Agent Development Kit(ADK)를 사용하여 단일 날씨 에이전트에서 출발해 고급 멀티 에이전트 시스템으로 확장하는 과정을 살펴보았습니다.

**구현한 주요 내용**:
- **기본 에이전트** 구성과 도구(`get_weather`) 정의 및 사용
- **LiteLLM**을 통한 다양한 모델(Gemini, GPT, Claude 등) 통합
- **서브 에이전트**(`greeting_agent`, `farewell_agent`) 생성 및 **자동 위임** 메커니즘 구현
- **Session State**를 통한 기억력 부여 및 개인화(온도 단위 선호도)
- **콜백 기반 안전 장치**를 통한 입력 및 도구 호출 제어

**핵심 개념 요약**:
- **에이전트 & 도구**: 기능 정의의 기본 단위로, 명확한 지침과 docstring이 중요
- **위임(Delegation)**: 복잡한 작업을 모듈화하여 전문화된 에이전트에게 분배
- **세션 상태**: 대화 컨텍스트를 유지하고 개인화된 응답 제공
- **콜백 시스템**: LLM 호출과 도구 실행 전에 안전 검사 및 제어 수행
- **유연성**: 다양한 모델과 도구 조합으로 최적의 성능 구현

**확장 방향**:
- 실제 날씨 API 연동으로 mock 데이터 대체
- 더 복잡한 세션 상태 관리(선호 도시, 알림 설정 등)
- 추가 하위 에이전트(예측 에이전트, 요약 에이전트 등) 구현
- 고급 콜백 활용(`after_model_callback`, `after_tool_callback` 등)
- 상태 영속화를 위한 데이터베이스 연동
- 실시간 UI 통합

ADK는 LLM 기반 애플리케이션을 효과적으로 구조화하고 안전하게 구축할 수 있는 강력한 프레임워크를 제공합니다. 이 튜토리얼에서 배운 개념들은 복잡한 실제 애플리케이션 개발에 직접 적용할 수 있습니다.
